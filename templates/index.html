<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Bot Vital Health</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        function mostrarSeccion(id) {
            const secciones = document.querySelectorAll('.seccion');
            secciones.forEach(sec => sec.classList.remove('activo'));
            document.getElementById(id).classList.add('activo');
        }
    </script>
</head>

<body>
<div class="contenedor">

<h1>ğŸ‘‹ Bot Vital Health</h1>

{% if not nombre %}
<form method="post">
    <input type="hidden" name="accion" value="datos">
    <label>Nombre:</label>
    <input type="text" name="nombre" required><br>
    <label>Edad:</label>
    <input type="number" name="edad" required><br>
    <button type="submit">Entrar</button>
</form>

{% else %}
<p>Hola, <strong>{{ nombre }}</strong> ğŸ˜Š</p>
<hr>

<!-- Botones de Secciones -->
<div class="menu-secciones">
    <button type="button" onclick="mostrarSeccion('productos')">Productos</button>
    <button type="button" onclick="mostrarSeccion('kits_te')">Kits de TÃ©</button>
    <button type="button" onclick="mostrarSeccion('kits_perdida')">Kits de PÃ©rdida de Peso</button>
    <button type="button" onclick="mostrarSeccion('contacto')">Hablar con Asesor</button>
    <button type="button" onclick="mostrarSeccion('carrito')">Carrito</button>
</div>

<!-- SecciÃ³n Productos -->
<div id="productos" class="seccion activo">
    <h2>ğŸ’Š Productos Disponibles</h2>
    
    <form method="post">
        <input type="hidden" name="accion" value="consultar">
        <input type="text" name="producto" placeholder="Escribe tu producto..." required>
        <button>Buscar</button>
    </form>

    {% if mensaje %}
    <p class="mensaje">{{ mensaje }}</p>
    {% endif %}

    {% if producto_encontrado %}
    <p>Producto encontrado: {{ producto_encontrado }} â€“ ${{ precio }}</p>
    <form method="post">
        <input type="hidden" name="accion" value="agregar">
        <input type="hidden" name="producto_real" value="{{ producto_encontrado }}">
        <button>Agregar al carrito</button>
    </form>
    {% endif %}

    {% if sugerencias %}
    <div class="sugerencias">
        <p>Â¿Quisiste decir?</p>
        {% for s in sugerencias %}
        <form method="post" style="display:inline-block">
            <input type="hidden" name="accion" value="agregar">
            <input type="hidden" name="producto_real" value="{{ s }}">
            <button>{{ s }} â€“ ${{ productos.get(s, 0) }}</button>
        </form>
        {% endfor %}
    </div>
    {% endif %}

    <hr>
    <h3>Todos los productos</h3>
    {% for p, precio in productos.items() %}
    <form method="post" class="producto-form">
        <input type="hidden" name="accion" value="agregar">
        <input type="hidden" name="producto_real" value="{{ p }}">
        {{ p }} â€“ ${{ precio }}
        <button>Agregar al carrito</button>
    </form>
    {% endfor %}
</div>

<!-- SecciÃ³n Kits de TÃ© -->
<div id="kits_te" class="seccion">
    <h2>ğŸµ Kits de TÃ©</h2>
    {% for k, precio in kits_te.items() %}
    <form method="post" class="producto-form">
        <input type="hidden" name="accion" value="agregar">
        <input type="hidden" name="producto_real" value="{{ k }}">
        {{ k }} â€“ ${{ precio }}
        <button>Agregar al carrito</button>
    </form>
    {% endfor %}
</div>

<!-- SecciÃ³n Kits de PÃ©rdida de Peso -->
<div id="kits_perdida" class="seccion">
    <h2>ğŸ‹ï¸ Kits de PÃ©rdida de Peso</h2>
    {% for k, precio in kits_perdida.items() %}
    <form method="post" class="producto-form">
        <input type="hidden" name="accion" value="agregar">
        <input type="hidden" name="producto_real" value="{{ k }}">
        {{ k }} â€“ ${{ precio }}
        <button>Agregar al carrito</button>
    </form>
    {% endfor %}
</div>

<!-- SecciÃ³n Contacto -->
<div id="contacto" class="seccion">
    <h2>ğŸ’¬ Hablar con un Asesor</h2>
    <a href="https://wa.me/50767930582?text=Hola%20ğŸ˜Š,%20soy%20{{ nombre }}%20y%20tengo%20{{ edad }}%20aÃ±os.%20Deseo%20hablar%20con%20un%20Asesor%20de%20Bienestar" target="_blank">
        Iniciar chat por WhatsApp
    </a>
</div>

<!-- SecciÃ³n Carrito -->
<div id="carrito" class="seccion">
    <h2>ğŸ›’ Carrito</h2>
    {% if carrito %}
    <ul>
        {% for p in carrito %}
        <li>
            {{ p }} - $
            {{ productos.get(p, kits_te.get(p, kits_perdida.get(p, 0))) }}
            <form method="post" style="display:inline-block">
                <input type="hidden" name="accion" value="quitar">
                <input type="hidden" name="producto_real" value="{{ p }}">
                <button>âŒ Quitar</button>
            </form>
        </li>
        {% endfor %}
    </ul>
    <p><strong>Total:</strong> ${{ total }}</p>

    <form method="post">
        <input type="hidden" name="accion" value="finalizar">
        <button>ğŸ“² Finalizar compra por WhatsApp</button>
    </form>
    {% else %}
    <p>Carrito vacÃ­o</p>
    {% endif %}
</div>

{% endif %}
</div>
</body>
</html>
